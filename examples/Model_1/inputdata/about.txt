Программа для расчета полных и удельных переменных затрат. Демонстрационная версия.
Copyright (R) Пидкасистый Александр Павлович, 2024.

В разные периоды времени предприятием закупаются разные по объему и закупочным ценам партии сырья и материалов. Часть сырья и материалов формирует переходящий запас на Складе ресурсов, другая часть - направляется на Производство продукции. Готовая продукция направляется на другой склад - Склад готовой продукции. Часть продукции формирует переходящий запас на Складе готовой продукции, другая часть - отгружается покупателям.

Программа позволяет рассчитать:

- объем производства продукции, необходимый для отгрузки потребителям и поддержания требуемого запаса на Складе готовой продукции;
- объем закупок сырья и материалов, необходимый для производства продукции и поддержания требуемого запаса на Складе ресурсов;
- учетную себестоимость сырья и материалов, направляемых в производство;
- учетную себестоимость остатков сырья и материалов на Складе ресурсов;
- материальную себестоимость продукции, направляемой на склад готовой продукции;
- материальную себестоимость готовой продукции, отгружаемой покупателям;
- материальную себестоимость остатков продукции на Складе готовой продукции.

Себестоимость сырья и материалов и готовой продукции рассчитывается исходя из выбранного принципа учета запасов: FIFO ("первым вошел - первым вышел"), LIFO ("последним вошел - первым вышел"), или AVERAGE ("по-среднему").

Моделируемое предприятие состоит из трех основных подразделений и одного центра затрат:

- Склад ресурсов для хранения сырья и материалов описывается классом clsStorage из модуля warehouse библиотеки froma2;
- Производство описывается классом clsManufactory из модуля manufact библиотеки froma2;
- Склад готовой продукции описывается классом clsStorage из модуля warehouse библиотеки froma2.

Центром затрат является Производство,описываемое классом clsManufactory из модуля manufact.

Объединяющей оболочкой для обоих складов и производства выступает класс clsEnterprise, являющийся потомком класса clsBaseProject модуля baseproject библиотеки froma2.

Исходные данные для моделирования располагаются в csv-файлах в папке inputdata:

- ship.csv - объемы отгрузок покупателям в натуральном измерении;
- manufvol.csv - объемы производства в натуральном измерении (файл используется в случае установки флага автоматического/ ручного расчета закупок в режим "ручной");
- recipe_0.csv, recipe_1.csv, recipe_2.csv, recipe_3.csv, recipe_4.csv, recipe_5.csv - рецептуры продуктов;
- rowmatprices.csv - цены сырья и материалов в разные периоды времени;
- rowmatvolume.csv - объемы закупок сырья и материалов (файл используется в случае установки флага автоматического/ ручного расчета закупок в режим "ручной").

Имена файлов для импорта, строки и столбцы для чтения, символ разделителя данных, а также принцип учета запаса и валюта проекта задаются в конфигурационном файле с именем config.cfg. Программа читает конфигурационный файл, при его отсутствии предлагает ввести данные с экрана, записывает данные в новый конфигурационный файл. При желании пользователя, в программе можно отредактировать и сохранить существующий конфигурационный файл.

Для чтения исходных данных из файлов и преобразование к формату ввода в классы clsStorage и clsManufactory используется класс clsImpex из модуля Impex библиотеки froma2.

Для вывода исходных и расчетных данных в читаемом табличном виде используется класс clsRePrint из модуля common_values библиотеки froma2. Отчет с текстом и таблицами выводится в файл с именем Model_1_LR.txt (или Model_1_DB.txt) в папку reports. Суффикс LR или DB показывает какой тип вещественных чисел использовался для расчётов (LongReal или double).

Исходные данные и результаты расчетов выводятся также в CSV-файлы в папку outputdata. Для вывода этих файлов используется класс clsImpex из модуля Impex библиотеки froma2. Имена файлов начинаются с символа 'f' (от названия библиотеки froma2), далее через нижнее подчеркивание следует символ, обозначающий подразделение:
	w - Склад Готовой продукции (warehouse);
	r - Склад Сырья и Материалов (rowmatstock);
	m - Производство (manufactory).
Следующий символ обозначает вид выводимого в файл массива:
	s - отгрузки (shipment);
	b - остатки (balance);
	p - поставки (purchase).
Далее через нижнее подчеркивание следует тип выводимых данных:
	volume - в натуральном измерении;
	price - в удельном стоимостном измерении;
	value - в полном стоимостном измерении.
Далее через нижнее подчеркивание следуют два символа, характеризующие тип вещественного числа, используемого программой:
	LR - вещественное число типа LongReal (встроенный в библиотеку тип для операций с длинными числами, модуль LongReal);
	DB - вещественное число типа double (стандарт C++).

Например, файл с именем f_wb_price_LR.csv содержит данные об удельной стоимости остатков на Складе Готовой продукции. При расчетах использовался тип вещественных чисел LongReal.

Логика работы программы:

0 этап.
Импорт данных из csv-файлов, определение числа позиций и названий продуктов, числа позиций и названий сырья и материалов, длительности проекта, единиц измерения продуктов и сырья. Задание принципа учета запасов, способа расчета получаемых на склады продукции и ресурсов (ручной или автоматический), разрешений/запретов на получение и отгрузку со склада в один и тот же период (например, когда поступление на склад осуществляется в конце периода, а отгрузка - только в следующем, возможно установить запрет).

1 этап.
Создание Склада готовой продукции на основе экземпляра класса clsStorage, ввод данных о продажах продукции клиентам в натуральном измерении. Расчет производственной программы в натуральном измерении, обеспечивающей необходимый объем для отгрузки потребителям и требуемый запас продукции на складе.

2 этап.
Создание Производства на основе экземпляра класса clsManufactory, ввод производственной программы и рецептур продуктов. Расчет потребности в сырье и материалах в натуральном измерении.

3. этап.
Создание Склада ресурсов на основе экземпляра класса clsStorage, ввод данных о потребности в сырье и материалах в натуральном измерении для Производства, ввод цен на сырье и материалы, расчет объемов закупаемых сырья и материалов. Расчет учетной себестоимость сырья и материалов, направляемых в производство и образующих запас на складе.

4.этап.
Расчет материальной себестоимости продукции, направляемой на Склад готовой продукции из Производства.

5 этап.
Расчет материальной себестоимости продукции, отгружаемой покупателям со Склада готовой продукции и образующих запас на складе.
